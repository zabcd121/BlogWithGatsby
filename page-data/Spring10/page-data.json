{"componentChunkName":"component---src-templates-post-template-tsx","path":"/Spring10/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>10일차 공부(2022.06.27)</h2>\n<h1>JPA</h1>\n<h2>1. 특징</h2>\n<h4>(1) Connection, PreparedStatement, Resultset 등 반복 코드는 물론이고, 기본적인 SQL까지 JPA가 직접 만들어서 실행해줌</h4>\n<h4>(2) SQL과 데이터 중심의 설계에서 객체 중심의 설계로 패러다임을 전환 할 수 있다.</h4>\n<h4>(3) 개발 생산성을 크게 향상된다.</h4>\n<h4>(4) JPA는 자바 표준 인터페이스이고, 구현체는 Hibernate등등의 vendor들이 있음.</h4>\n<h4>(5) JPA를 Spring에서 한번 감싸서 제공하는게 Spring Data JPA임.</h4>\n<h2>1. 초기 설정</h2>\n<h3>1. build.gradle에 jpa추가</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">implementation 'org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token operator\">:</span>spring<span class=\"token operator\">-</span>boot<span class=\"token operator\">-</span>starter<span class=\"token operator\">-</span>data<span class=\"token operator\">-</span>jpa'</code></pre></div>\n<h3>2. resources/application.properties</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">spring<span class=\"token punctuation\">.</span>jpa<span class=\"token punctuation\">.</span>show<span class=\"token operator\">-</span>sql<span class=\"token operator\">=</span><span class=\"token boolean\">true</span>  <span class=\"token comment\">//jpa가 날리는 sql을 볼 수 있게 함.</span>\r\nspring<span class=\"token punctuation\">.</span>jpa<span class=\"token punctuation\">.</span>hibernate<span class=\"token punctuation\">.</span>ddl<span class=\"token operator\">-</span>auto<span class=\"token operator\">=</span>none <span class=\"token comment\">//jpa를 사용하면 객체를 보고 자동으로 테이블을 만들어주는데 그 기능을 끄려면 none하면 됨. 자동 생성하려면 create로 설정</span></code></pre></div>\n<h2>2. Example</h2>\n<h3>1. Member.class</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Member</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token annotation punctuation\">@Id</span> <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\r\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>ORM(Object Relational db Mapping)을 하기 위해서 <strong>@Entity</strong>를 도메인 클래스에 붙여주면 JPA가 Entity로써 관리해줌.</h4>\n<h4>그리고 pk를 지정해줘야 하는데 DB가 자동으로 1씩 늘어나는 키를 부여하도록 하고 싶으면 @GeneratedValue에 IDENTITY전략을 설정해줘야 함.</h4>\n</blockquote>\n<br/>\n<h3>2. MemberRepository.class</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JpaMemberRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MemberRepository</span><span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JpaMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>em <span class=\"token operator\">=</span> em<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>JPA는 <strong>EntityManager</strong>를 통해서 모든게 동작하게 됨.</h4>\n<h4>따라서 JPA를 쓰려면 EntityManager를 주입받아야 함.</h4>\n<h4>아까 위에서 JPA 라이브러리를 Dependencies에 추가했는데 그러면 spring boot가 자동으로 EntityManager를 현재 db와 연결해서 자동으로 만들어줌.</h4>\n<h4>EntityManager 내부에서 DataSource를 가지고 있어서 db와 연결하고 하는 과정 등을 처리해준다.</h4>\n</blockquote>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Override</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        em<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Override</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Override</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m where m.name = :name\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">setParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Override</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\r\n        <span class=\"token keyword\">return</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>이제 EntityManager를 통하여 insert의 경우 persist메서드를 사용하면 내부에서 쿼리를 다 작성해서 보내준다!!😲</h4>\n<h4>JPQL을 사용하여 쿼리를 생성해야할 때도 있다.</h4>\n<h4>Spring Data JPA를 사용하면 JPQL을 짤 필요가 없다.</h4>\n</blockquote>\n<br/>\n<h3>3. MemberService.class</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Transactional</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberService</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberService</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>memberRepository <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>데이터를 저장하거나 변경할 때는 항상 트랜잭션이 있어야 하므로 @Transaction을 클래스나 아니면 트랜잭션이 필요한 메서드에 붙여준다.</h4>\n</blockquote>\n<h3>4. SpringConfig.class</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringConfig</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Autowired</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringConfig</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>em <span class=\"token operator\">=</span> em<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Bean</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberService</span> <span class=\"token function\">memberService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MemberService</span><span class=\"token punctuation\">(</span><span class=\"token function\">memberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Bean</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token function\">memberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JpaMemberRepository</span><span class=\"token punctuation\">(</span>em<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>EntityManager를 Autowired로 자동 주입받고 Repository로 넘겨준다.</h4>\n</blockquote>\n<br/>\r\n<br/>\n<h1>Spring Data JPA</h1>\n<h4>위에서 JPA를 사용해봤는데 코드가 이전에 비해 확 줄어든걸 체감할 수 있었다.</h4>\n<h4>그런데 Spring Data JPA를 사용하면 Repository에 구현 클래스 없이 인터페이스 만으로 개발을 할 수 있고 기본 CRUD 기능도 모두 제공해준다고 한다. 이제 알아보자!</h4>\n<h2>1. Example</h2>\n<h3>1. SpringDataJpaMemberRepository.interface</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">SpringDataJpaMemberRepository</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">JpaRepository</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Override</span>\r\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>이런식으로 인터페이스 Repository를 생성하고 JpaRepository를 상속받는데 제네릭 타입 첫번째에 객체 타입을 적고, 두번째에 그 객체의 PK타입을 적으면 된다.</h4>\n<h4>그리고 인터페이스는 다중상속이 가능하므로 기존에 만들었던 MemberRepository를 상속받는다.</h4>\n<h4>그 후 findByName을 예시로 써보자</h4>\n<h4>끝!? 구현은 안해도 된다!!!😙</h4>\n</blockquote>\n<blockquote>\n<h4>JpaRepository를 상속받으면 스프링 데이터 JPA가 자동으로 구현체를 만들어줘서 Spring Bean으로 자동 등록해준다.</h4>\n<h4>그거를 우리는 가져와서 쓰면 된다.</h4>\n</blockquote>\n<h3>2. SpringConfig.class</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringConfig</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Autowired</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringConfig</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>memberRepository <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n\r\n    <span class=\"token annotation punctuation\">@Bean</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberService</span> <span class=\"token function\">memberService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MemberService</span><span class=\"token punctuation\">(</span>memberRepository<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<h4>이렇게 MemberRepository를 @Autowired를 통해 자동 주입받도록 설정하고 Service에 넘겨주면 되는데 이 MemberRepository 객체는 뭐가 들어가는걸까?</h4>\n</blockquote>\n<br/>\n<blockquote>\n<h4>아까 JpaRepository를 상속하면 자동으로 인터페이스의 구현체가 만들어진다고 했었는데 그때 만들어진 SpringDataJpaMemberRepository 인터페이스의 구현체가 주입되게 된다.</h4>\n</blockquote>\n<h3>JpaRepository 인터페이스의 상위 인터페이스</h3>\n<h4>내부 구현 코드로 들어가보니</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 481px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d84af8f27b5c35303cd69652cedb0522/213b2/JpaRepository.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 138.02083333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAChUlEQVRIx6WV6W7iUAyFef8XohJCqIgfgEBlX0vLUjYBgYSdAh59Vp1JmTJkNJGsm9zl3GP72In0+315fX2VZrMp3W5Xrter/M8TAahSqUihUJBGoyGr1UrW67V4nieO4+hotlwu/fV7Ftnv9z467D4/P+V8PutBjAtrtZpUq1WZTCayWCx0z61dLhfZbDa/AW9d5bbtdqvsE4mEZDIZmc/nyvLeczgcvgMaKCM3YjzT6VROp5O+MxfcFzwH1h8MYea6rrIjhqVSSXK5nLy8vAgJZJ15XL8l8iMgLr29vWnGGXEVwHQ6rUkjTsR2NpuFA4QdQPV6XeUEgLkbTJ7nOOEAub3dbmtWYfn+/q7ZPR6P/mHi6LlueMDBYKCG9pBQkJkmBoaeFw6Q1OO2CRWXYYpkTPC2/hDQZ/AlGZMNiUK8wbUg678y3O12PhPcJ0Fkl7gSS6sg919iOBwOtTqSyaQ8Pz9LLBaTaDQqqVRKax49Oo+ybG4AWC6XVXfoj9Ij48Vi0dchFlrYAFMlGAdxH+kAwBwhwW616dcym0xbSISRzegOIxkGxrvNcxgyZnwT9wgVgWvZbFbrNp/Pa1mxARA2Ixk2824MsSAgxkUR69itVkt6vZ5qjjgCaK4ZQ5szAAtNMETfGiwPACZoWMGOi0ajkd+tkQxrhOdugw1mGRAbn56eJB6Pq5FlGAa7zd0GG6wKDtL/rOsgagDMVUCdsN0Gd4gpAiZJAPJfGY/H2jCIlTXi0JXS6XQUFFYAWVM1Vtq+wnYbGJJxDEGTEKth9lpzCA1ov07KjRJkhDFszU2e0IBsJG6AMX58fKirJIL4mWzsd/oQkJESDP5K+Uaftz/2nwB/ASwTZ+a0V+mSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d84af8f27b5c35303cd69652cedb0522/a59e9/JpaRepository.webp 192w,\n/static/d84af8f27b5c35303cd69652cedb0522/0ca9f/JpaRepository.webp 384w,\n/static/d84af8f27b5c35303cd69652cedb0522/e95f8/JpaRepository.webp 481w\"\n              sizes=\"(max-width: 481px) 100vw, 481px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d84af8f27b5c35303cd69652cedb0522/3b721/JpaRepository.png 192w,\n/static/d84af8f27b5c35303cd69652cedb0522/66595/JpaRepository.png 384w,\n/static/d84af8f27b5c35303cd69652cedb0522/213b2/JpaRepository.png 481w\"\n            sizes=\"(max-width: 481px) 100vw, 481px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d84af8f27b5c35303cd69652cedb0522/213b2/JpaRepository.png\"\n            alt=\"Untitled\"\n            title=\"Untitled\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h4>그림과 같이 여러 Repository를 상속하고 있었다.</h4>\n<h2>2. Reflection</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Override</span>\r\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<blockquote>\n<h4>아까 SpringDataJpaMemberRepository에서 위와 같은 메서드를 Override했는데 이것의 동작원리는 내부적으로 JPQL로 변환하여</h4>\n<h4>select m from Member m where m.name = ? 와 같이 만들어준다.</h4>\n</blockquote>\n<br/>\n<blockquote>\n<h4>그리고 findByNameAndId(String name, Long id); 와 같이 And나 Or을 사용해서 여러 메서드들을 생성할 수 있다.</h4>\n</blockquote>\n<br/>\n<blockquote>\n<h4>기본적으로 변수 이름이 어떤 사람은 name으로 쓰고 어떤사람은 username으로 쓸 수도 있는데 어떻게 이게 가능한가?</h4>\n<ul>\n<li>\n<h4>내부적으로 변수, 메서드이름, 파라미터 들을 reflection 기술을 이용하여 새로운 쿼리를 만들어내는 것!</h4>\n</li>\n</ul>\n</blockquote>\n<br/>\n<blockquote>\n<h4>참고)</h4>\n<h4>이런식으로 실무에서는 JPA와 Spring Data JPA를 기본으로 사용하고,</h4>\n<h4>복잡한 동적 쿼리는 Querydsl 라이브러리를 사용한다고 한다.</h4>\n<h4>이 조합으로도 해결 불가한 쿼리는 JPA가 제공하는 Native Query를 사용하거나 JdbcTemplate을 사용하면 된다.</h4>\n</blockquote>\n<h4>지금까지 순수 Jdbc, JdbcTemplate, JPA, Spring Data JPA 순서대로 사용해봤는데</h4>\n<h4>점점 더 개발자가 편하게 코딩할 수 있도록 발전된 것을 경험할 수 있었다.</h4>\n<h4>심지어 Spring Data JPA는 SQL문까지 자동으로 만들어주니 놀라웠다.</h4>\n<h4>하지만 기본적으로 내가 라이브러리 도움 없이 짤 수 있도록 공부를 해야할 것 같다.</h4>","frontmatter":{"title":"7. Spring DB 접근 기술 - JPA","summary":"10일차 공부","date":"2022.06.27.","categories":["Spring"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQoz61T22rCQBDdD+3f+NgPEOyDpVTBJ6GClIgUCyK0YNEqQZNWvBXBS7ReEhNnj2RsJIatIDgw7Oywc+ZyZgWuLCIwpJSsKvtiwFMAAskdn4H/nEbjRRj90mpUcccKSRI7OrMmYi83KJhpvm89G7a3hkcuFs4Uc3vMHWzcJfuioxHRDOnaLTTjEYO5gaVj4bn9gOJXBvlWEjn9Dk96gu3XThbmpHYckxLQz/w+KOBzVIY5rWPjrqAZKWSbcVR6eTRGFXz8lPDW13BfjaFr6X9xpGL54Px1LK4gyO6L33JYfIDh4hs78tSknFuRMPvhWf9HpFDtHXEwKdfj9I1Us3zNn7IHJa9YN0fygIsAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/ecbfb406b152e2d40fa0e7f87d5b8b97/2ae51/Spring.png","srcSet":"/static/ecbfb406b152e2d40fa0e7f87d5b8b97/4b853/Spring.png 300w,\n/static/ecbfb406b152e2d40fa0e7f87d5b8b97/1886e/Spring.png 600w,\n/static/ecbfb406b152e2d40fa0e7f87d5b8b97/2ae51/Spring.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/ecbfb406b152e2d40fa0e7f87d5b8b97/b3177/Spring.webp 300w,\n/static/ecbfb406b152e2d40fa0e7f87d5b8b97/ea367/Spring.webp 600w,\n/static/ecbfb406b152e2d40fa0e7f87d5b8b97/8ab23/Spring.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":675}},"publicURL":"/static/ecbfb406b152e2d40fa0e7f87d5b8b97/Spring.png"}}}}]}},"pageContext":{"slug":"/Spring10/"}},"staticQueryHashes":[]}